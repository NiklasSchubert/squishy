{% extends 'onboarding/wizard_base.html' %}

{% block title %}Squishy Setup - Media Libraries{% endblock %}

{% block wizard_title %}Media Library Selection{% endblock %}

{% set current_step = 2 %}

{% block wizard_content %}
<div class="step-description">
    <p>
        Select which media libraries from your server you want to include in Squishy.
        Only selected libraries will be scanned for media that can be transcoded.
    </p>
</div>

<div class="step-form">
    <form action="{{ url_for('onboarding.save_libraries') }}" method="post" id="libraryForm">
        <div class="library-actions">
            <button type="button" id="toggleAllLibrariesBtn" class="button mini">Toggle All</button>
            <button type="button" id="enableAllLibrariesBtn" class="button mini success">Enable All</button>
            <button type="button" id="disableAllLibrariesBtn" class="button mini danger">Disable All</button>
        </div>
        
        <div id="libraryList" class="libraries-container">
            <div class="loading">
                <div class="spinner"></div>
                <p>Loading available libraries...</p>
            </div>
        </div>
        
        <div class="no-libraries-warning" style="display: none;">
            <div class="warning-icon">⚠️</div>
            <p>No libraries were found. Please check your media server configuration and ensure it has at least one library.</p>
            <p><a href="{{ url_for('onboarding.step', step=1) }}" class="button secondary">Back to Media Source</a></p>
        </div>
    </form>
</div>
{% endblock %}

{% block wizard_actions %}
<button type="submit" form="libraryForm" class="button primary">Continue</button>
{% endblock %}